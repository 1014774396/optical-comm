\documentclass[a4paper]{article}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[numbered]{bookmark}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{pifont}
\usepackage{tikz}
\usepackage{bm}


\title{Coherent Detection Systems for Data Centers}

\author{JKP}

\date{\today}

\begin{document}
\maketitle

\section{Transmitter}
\subsection{Intensity Noise}
Modeled as an AWG noise added to the optical power at the transmitter.

The value of RIN is defined as the ratio between the noise power divide by the noise bandwidth and the signal power \cite{agilent-RIN-measurement}: 
\begin{equation}
RIN = \frac{P_{noise}}{B_{noise}P_{signal}}
\end{equation}

Thus the \textbf{one-sided RIN PSD} and \textbf{RIN variance} at a certain instant are given by
\begin{align}
& S_{RIN}(t) = RIN\cdot P(t)^2 \\
& \sigma^2_{RIN}(t) = S_{RIN}(t)\frac{f_{s, sim}}{2}
\end{align}
where $f_{s, sim}$ is the sampling frequency to simulate continuous time. Obviously, the variance as defined here only make sense in simulations. Since the intensity noise is assumed to be white, it'd have infinite variance.

Output optical power $P(t)$ is given by
\begin{equation}
P(t) = P_s(t) + w_{RIN}(t)
\end{equation}
where $P_s(t)$ is the signal-only optical power (after modulator frequency response and extinction ratio), and $w_{RIN}(t)\sim\mathcal{N}(0, \sigma^2_{RIN}(t))$.

\subsection{Phase Noise}
Phase noise is modeled as a Wiener process (Gaussian distributed with independent increments).

\begin{equation}
\phi(t+\tau) - \phi(t) \sim\mathcal{N}(0, 2\pi\Delta\nu\tau),
\end{equation} 
where $\Delta\nu$ is the laser linewidth. 

The coherence time is defined as a delay difference yielding an rms value for the phase change of $\sqrt{2}$ rads.

\subsection{Modulator Bandwidth Limitations}


\section{Fiber Propagation}
\subsection{Chromatic Dispersion}
\begin{equation}
H(f; L) = \frac{E(f; L)}{E(f, 0)} = e^{-1/2\beta_2(2\pi f)^2L}
\end{equation}
where $H(f; L)$ is fiber frequency response due to dispersion after $L$ meters, and $\beta_2 = -\frac{D(\lambda)\lambda^2}{2\pi c}$. 

Fiber attenuation can be included with the factor $e^{-\frac{1}{2}\frac{att(\lambda)L}{10^4}}$, where $att(\lambda)$ is the fiber attenuation at wavelength $\lambda$ in dB/km.

For SMF28 the fiber dispersion is specified in terms of the zero-dispersion ($\lambda_0$) wavelength and the dispersion slope ($S_0$):
\begin{equation}
D(\lambda) = \frac{S_0}{4}\bigg(\lambda - \frac{\lambda_0^4}{\lambda^3}\bigg), 1200~\text{nm} < \lambda < 1600~\text{nm}
\end{equation}

\subsection{Polarization-Mode Dispersion}
Following \cite{Ip2008}

The output $\bm{y}(t)$ after fiber propagation is given by
\begin{equation}
\bm{r}(t) = \bm{h}(t)\ast \bm{x}(t) + \bm{n}(t)
\end{equation}
where, $\bm{x}(t) = [x_1(t), x_2(t)]^T$, $\bm{n}(t) = [n_1(t), n_2(t)]^T$ and $\bm{h}(t)$ is the matrix representation of the fiber impulse response
\begin{equation}
\bm{h}(t) = \begin{bmatrix}
h_{11}(t) & h_{12}(t) \\
h_{21}(t) & h_{22}(t) \\
\end{bmatrix}
\end{equation}
In the frequency domain
\begin{equation}
\bm{H}(\omega) = \begin{bmatrix}
\cos\theta & -\sin\theta \\
\sin\theta & \cos\theta
\end{bmatrix}\begin{bmatrix}
e^{j\omega\tau/2} & 0 \\
0 & e^{-j\omega\tau/2}
\end{bmatrix}\begin{bmatrix}
\cos\theta & \sin\theta \\
-\sin\theta & \cos\theta
\end{bmatrix}
\end{equation}

The first matrix from the right rotates the input polarization state to the principal states of polarization (PSPs). The second matrix adds a differential group dealy (DGD) $\tau$ between the two PSPs. Finally, the last matrix from the right rotates the PSPs to the output state of polarization.

This formulation can model both CD and PMD of any order. In simulation, we do CD and PMD separately, since for modeling PMD the fiber has to be broken into small sections.

Hence the fiber propagation is modeled in the frequency domain as
\begin{equation}
\bm{Y}(\omega) = \Big(\bm{H_N}(\omega)\ldots \bm{H_1}(\omega)\Big)\times e^{-\frac{1}{2}\beta_2\omega^2L}
\end{equation}
where each of the $N$ sections of the fiber has frequency response matrix $\bm{H_i}(\omega)$ with a random phase $\theta_i \in [-\pi, \pi]$.
\section{Receiver}

\subsection{Fractionally spaced linear equalizer}
Assuming an oversampling ratio $r_{os} = p/q$, $p, q \in \mathrm{Z^*_+}$, which need not be integer. We can compensate for intersymbol interference (ISI) and demultiplex the two polarizations as long as frequency and phase noise are small.

Samples at the equalizer input $\bm{X}[k]$, where $x_1[k], x_2[k]$ are the complex samples from the two polarizations. $k$ is at a rate $T_s/r_{os}$.

The equalizer output can be written as
\begin{align}
\hat{x}_{1}[k] = w^{(i)}_{11}[k]\ast x_1[k] + w^{(i)}_{12}[k]\ast x_2[k] \\
\hat{x}_{2}[k] = w^{(i)}_{21}[k]\ast x_1[k] + w^{(i)}_{22}[k]\ast x_2[k]
\end{align}

where $i = 1, \ldots, q$. We need a total of $q$ filters because in the case of non-interger oversampling ratio the samples do not align. For instance, If $r_{os} = 3/2$, we need two sets of filters, one for the odd samples and another for the even samples.

Since the number of operations in linear filter scales with $\mathcal{O}(N_{taps}^2)$, the total number of operations for this configuration scales with $\mathcal{O}(4qN_{taps}^2)$.

\subsection{Constant Modulus Algorithm}

Constant Modulus Algorithm (CMA) is a blind equalization algorithm that relies on the fact that PSK or 4-QAM constellations have a constant modulus. 

For being a blind algorithm, CMA cannot separate the symbols. If there's a fixed phase error CMA will converge to that phase offset. If there's a mismatch between the transmitter and local oscillator, the CMA output will rotate at a rate that is the difference between the two frequencies. For this reason, the constellation diagram after CMA is typically a circle. 

CMA with phase tracking decision directed algorithm can detected the symbols. First, the blind CMA is run in order to compensate for ISI, and separate the two polarizations. After this stage and downsampling to the symbol rate, there's a phase tracking adaptive algorithm that rotates the symbols to the appropriate positions. For each polarization stream we would have:

\begin{align}
\hat{y}[n] &= y_{cma}[n]e^{j\phi[n]} \\
e[n] &= \hat{y}[n] - y[n] \\
\phi[n]  &= \phi[n-1] - \mu\mathrm{Im}(\hat{y}[n]e^*[n])
\end{align}
where $y[n]$ is the expected symbol in the case of a training sequence, or simply the decision made from $\hat{y}[n]$ in the case of decision-directed training. $e[n]$ is the error and the last equation is the update equation.




\subsection{Polarization Recovery and PMD Compensation}
\subsection{CD Compensation}

`

\subsection{Carrier and Frequency Recovery}
\subsection{Equalization}



\begin{thebibliography}{9}
\bibitem{agilent-RIN-measurement} Product Note 86100-7; ``Digital Communication Analyzer (DCA), Measure Relative Intensity Noise (RIN),'' Agilent Technologies. 

\end{thebibliography}



\end{document}