%% Plot DSP results curves
clear, clc, close all

Lspan = 0:10;

% DP-QPSK
Preq_QPSK_eq3taps_InfENOB = [-31.2141358950562,-31.1229706011489,-31.1591194539452,-30.9146635596195,-30.9758760967616,-30.8998931468683,-30.8046841962965,-30.6914485860382,-30.5511625709054,-30.4674417218359,-30.3161365834978];
Preq_QPSK_eq7taps_InfENOB = [-31.9498868617519,-31.9987302705492,-32.0341815984697,-31.9416338673142,-31.9987940039397,-31.9827330721315,-31.8466706249457,-31.8830890329939,-31.8503934592411,-31.8291050230889,-31.8265647582677];

Preq_QPSK_eq3taps_4ENOB = [-30.4164745074869,-30.4058273271944,-30.3330441704541,-30.3715741109382,-30.2602322104346,-30.2036180718854,-29.9936936068042,-29.9671004192639,-29.7529982889092,-29.4985634102842,-29.3006527908808];
Preq_QPSK_eq7taps_4ENOB = [-31.4125107114068,-31.3779270998451,-31.3164488824664,-31.2780039701913,-31.3520527618346,-31.2563675630953,-31.0883355328784,-31.2731071351150,-31.1648786133992,-31.0440648321642, NaN];
    
Preq_QPSK_theory = [-33.0063808502409,-33.0063808502409,-33.0063808502409,-33.0063808502409,-33.0063808502409,-33.0063808502409,-33.0063808502409,-33.0063808502409,-33.0063808502409,-33.0063808502409,-33.0063808502409];

% DP-DQPSK
Preq_DQPSK_eq3taps_InfENOB = [-28.5788128916815,-28.5626405691903,-28.6419871779525,-28.4894136984189,-28.3043751156889,-28.1976885862331,-28.1051603613172,-27.8118468486740,-27.5357785262263,-27.1849408753666,-26.8333111812474];
Preq_DQPSK_eq7taps_InfENOB = [-29.4183066394404,-29.3546346269640,-29.3604921052442,-29.4577998241906,-29.3023880069243,-29.4265678869272,-29.2514976702647,-29.1323110995474,-29.1450062837477,-29.0536653474292,-28.9347525138089];

Preq_DQPSK_eq3taps_4ENOB = [-27.3275076187405,-27.2995218278071,-27.2906400726628,-27.2843187078283,-26.9775081148187,-27.0260913222949,-26.7156643969033,-26.3466551130548,-25.9464567278563,-25.6862249082236,-24.9183766804247];
Preq_DQPSK_eq7taps_4ENOB = [-28.5759823725237,-28.5881072647484,-28.5149634493557,-28.3864593191777,-28.1377898794805,-28.3563041429024,-28.2444937089901,-27.9931343088215,-28.0320526539319,-27.9677636706665,-27.4010913102741];

Preq_DQPSK_theory = [-30.6149901736139,-30.6149901736139,-30.6149901736139,-30.6149901736139,-30.6149901736139,-30.6149901736139,-30.6149901736139,-30.6149901736139,-30.6149901736139,-30.6149901736139,-30.6149901736139];

Color = {[51, 105, 232]/255, [255,127,0]/255};

figure, hold on, box on
plot(Lspan, Preq_QPSK_eq3taps_InfENOB, '-o', 'Color', Color{1}, 'LineWidth', 2, 'MarkerFaceColor', 'w')
plot(Lspan, Preq_QPSK_eq7taps_InfENOB, '--o', 'Color', Color{1}, 'LineWidth', 2, 'MarkerFaceColor', 'w')
plot(Lspan, Preq_QPSK_theory, ':', 'Color', Color{1}, 'LineWidth', 2)
plot(Lspan, Preq_DQPSK_eq3taps_InfENOB, '-o', 'Color', Color{2}, 'LineWidth', 2, 'MarkerFaceColor', 'w')
plot(Lspan, Preq_DQPSK_eq7taps_InfENOB, '--o', 'Color', Color{2}, 'LineWidth', 2, 'MarkerFaceColor', 'w')
plot(Lspan, Preq_DQPSK_theory, ':', 'Color', Color{2}, 'LineWidth', 2)
leg = legend('3-tap equalizer', '7-tap equalizer', 'AWGN limit', 'Location', 'NorthWest');
set(leg,  'FontSize', 12)
xlabel('Fiber length (km)', 'FontSize', 12)
ylabel('Receiver sensitivity (dBm)', 'FontSize', 12)
set(gca, 'FontSize', 12)
axis([0 10 -34 -24])

figure, hold on, box on
plot(Lspan, Preq_QPSK_eq3taps_4ENOB, '-o', 'Color', Color{1}, 'LineWidth', 2, 'MarkerFaceColor', 'w')
plot(Lspan, Preq_QPSK_eq7taps_4ENOB, '--o', 'Color', Color{1}, 'LineWidth', 2, 'MarkerFaceColor', 'w')
plot(Lspan, Preq_QPSK_theory, ':', 'Color', Color{1}, 'LineWidth', 2)
plot(Lspan, Preq_DQPSK_eq3taps_4ENOB, '-o', 'Color', Color{2}, 'LineWidth', 2, 'MarkerFaceColor', 'w')
plot(Lspan, Preq_DQPSK_eq7taps_4ENOB, '--o', 'Color', Color{2}, 'LineWidth', 2, 'MarkerFaceColor', 'w')
plot(Lspan, Preq_DQPSK_theory, ':', 'Color', Color{2}, 'LineWidth', 2)
leg = legend('3-tap equalizer', '7-tap equalizer', 'AWGN limit', 'Location', 'NorthWest');
set(leg,  'FontSize', 12)
xlabel('Fiber length (km)', 'FontSize', 12)
ylabel('Receiver sensitivity (dBm)', 'FontSize', 12)
set(gca, 'FontSize', 12)
axis([0 10 -34 -24])