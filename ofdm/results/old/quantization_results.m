%% Quantization results
clear, clc, close all
RCLIP = 3:0.5:7;

%% ENOB = 5

bercount_fbl5 = [0.001102936573518,0.001337687174479,0.002183963090946,0.002472315079127,0.004043579101563,0.004267374674479,0.005250197190505,0.004806518554688,0.006205240885417];
bercount_vbl5 = [0.005082350510817,0.005948971479367,0.007420075245393,0.008264003655849,0.009433061648638,0.010799701397236,0.009244087414864,0.009827833909255,0.010626768454527];

berest_fbl5 = [7.805483848777169e-04,0.001162688047620,0.001865138457412,0.002154298038872,0.003552668392463,0.003743050952448,0.004604688633739,0.004188569182216,0.005438082030718];
berest_vbl5 = [0.005065968673574,0.006126810329435,0.007555684775076,0.008426648669781,0.009522337621067,0.010943614892367,0.009258744076270,0.009684677937209,0.010459375249865];

%% ENOB = 6

bercount_fbl6 = [2.288818359375000e-04,7.472894130608975e-05,9.585649539262820e-05,1.146365434695513e-04,1.412416115785257e-04,1.588479066506410e-04,1.752804487179487e-04,1.686291816907051e-04,2.292730869391026e-04];
bercount_vbl6 = [0.001831837189503,0.001812274639423,0.001988337590144,0.002164009289864,0.002074412810497,0.002214480669071,0.002289992112380,0.002316205929487,0.002397194886819];

berest_fbl6 = [5.660989591803178e-05,6.383986995418529e-05,8.968475502813977e-05,1.132891110553893e-04,1.306242878054991e-04,1.547542418917216e-04,1.651353785342028e-04,1.634540731052860e-04,2.140261697644082e-04];
berest_vbl6 = [0.001939429434163,0.002106311679603,0.002324415750131,0.002495072420723,0.002405985713443,0.002520407829989,0.002564649052792,0.002636022414301,0.002628925039656];

%% ENOB = 7

bercount_fbl7 = [1.451541215945513e-04,2.425756209935897e-05,1.643254206730769e-05,2.191005608974359e-05,1.604129106570513e-05,1.760629507211538e-05,1.838879707532051e-05,2.464881310096154e-05,2.269255809294872e-05];
bercount_vbl7 = [0.001226180639022,0.001101371569511,0.001128759139623,0.001149495442708,0.001178448016827,0.001180795522837,0.001155755458734,0.001162797976763,0.001199184319912];

berest_fbl7 = [1.691395948158479e-05,1.796709487982848e-05,1.855231644411629e-05,2.071828418619670e-05,2.183360402916841e-05,2.412766922151724e-05,2.266160651171349e-05,2.429617131163511e-05,2.799417242470380e-05];
berest_vbl7 = [0.001344184335461,0.001381956743519,0.001401578625770,0.001463181489048,0.001466854950327,0.001475874960655,0.001471217284156,0.001493072625005,0.001503391089190];

%%
figure1 = figure;
plot(RCLIP, log10(berest_fbl5), '-sk', RCLIP, log10(bercount_fbl5), ':ok')
hold on
plot(RCLIP, log10(berest_fbl6), '-sr', RCLIP, log10(bercount_fbl6), ':or')
plot(RCLIP, log10(berest_fbl7), '-sb', RCLIP, log10(bercount_fbl7), ':ob')

legend('Estimated', 'Counted')

axis([RCLIP(1) RCLIP(end) -6 -1])
xlabel('Clipping ratio', 'FontSize', 12)
ylabel('log_{10}(BER)', 'FontSize', 12)
set(gca, 'FontSize', 12)

annotation(figure1,'textbox',...
    [0.744287671232877 0.611408201829441 0.16285518590998 0.07834499794154],...
    'String',{'ENOB = 5'},...
    'FontWeight','bold',...
    'FontSize',12,...
    'FitBoxToText','off',...
    'LineStyle','none');

% Create textbox
annotation(figure1,'textbox',...
    [0.747320939334638 0.467213988823529 0.16875048923679 0.0783449979415399],...
    'String',{'ENOB = 6'},...
    'FontWeight','bold',...
    'FontSize',12,...
    'FitBoxToText','off',...
    'LineStyle','none',...
    'Color',[1 0 0]);

% Create textbox
annotation(figure1,'textbox',...
    [0.750192759295499 0.243061555527065 0.16587866927593 0.07834499794154],...
    'String',{'ENOB = 7'},...
    'FontWeight','bold',...
    'FontSize',12,...
    'FitBoxToText','off',...
    'LineStyle','none',...
    'Color',[0 0 1]);


%% Variable BL
figure2 = figure;
plot(RCLIP, log10(berest_vbl5), '-sk', RCLIP, log10(bercount_vbl5), ':ok')
hold on

plot(RCLIP, log10(berest_vbl6), '-sr', RCLIP, log10(bercount_vbl6), ':or')

plot(RCLIP, log10(berest_vbl7), '-sb', RCLIP, log10(bercount_vbl7), ':ob')

legend('Estimated', 'Counted', 'Location', 'SouthEast')

axis([RCLIP(1) RCLIP(end) -6 -1])

xlabel('Clipping ratio', 'FontSize', 12)
ylabel('log_{10}(BER)', 'FontSize', 12)
set(gca, 'FontSize', 12)

% Create textbox
annotation(figure2,'textbox',...
    [0.738392367906066 0.650547322156864 0.16875048923679 0.0783449979415399],...
    'String',{'ENOB = 6'},...
    'FontWeight','bold',...
    'FontSize',12,...
    'FitBoxToText','off',...
    'LineStyle','none',...
    'Color',[1 0 0]);

% Create textbox
annotation(figure2,'textbox',...
    [0.739478473581213 0.504966317431828 0.16587866927593 0.07834499794154],...
    'String',{'ENOB = 7'},...
    'FontWeight','bold',...
    'FontSize',12,...
    'FitBoxToText','off',...
    'LineStyle','none',...
    'Color',[0 0 1]);

% Create textbox
annotation(figure2,'textbox',...
    [0.738930528375732 0.749503439924681 0.16285518590998 0.07834499794154],...
    'String',{'ENOB = 5'},...
    'FontWeight','bold',...
    'FontSize',12,...
    'FitBoxToText','off',...
    'LineStyle','none');


